# ü§ñ YouTube Comment Consultant

**AI-–∞–≥–µ–Ω—Ç –∑ function calling –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ YouTube**

–ü–µ—Ä—Å–æ–Ω–∞: –∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π, –≤–≤—ñ—á–ª–∏–≤–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é function calling.

## üéØ –û–ø–∏—Å

YouTube Comment Consultant ‚Äî —Ü–µ **–∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π AI-–∞–≥–µ–Ω—Ç** —É Telegram, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **function calling** –¥–ª—è —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å. –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª—ñ–∑—É—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ YouTube, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î **–≤–∏–∫–ª—é—á–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤** (—è–∫ NotebookLM) —ñ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏—Ä—ñ—à—É—î —è–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è .env

–°—Ç–≤–æ—Ä—ñ—Ç—å `.env` —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤—ñ `.env.example`:

```bash
# YouTube API –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
YOUTUBE_API_KEY=your_youtube_api_key_here

# OpenRouter API –¥–ª—è LLM –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó  
OPENROUTER_API_KEY=your_openrouter_api_key_here

# –ú–æ–¥–µ–ª—å –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: openai/gpt-4o-mini)
MODEL_SUMMARY=openai/gpt-4o-mini

# –ú–æ–¥–µ–ª—å –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞ –∑ function calling (–ø—ñ–¥—Ç—Ä–∏–º—É—î tools)
AGENT_MODEL=google/gemini-2.5-flash

# Telegram Bot Token (–æ—Ç—Ä–∏–º–∞–π—Ç–µ —É @BotFather)
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
```

### 3. –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞

```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
python run_bot.py

# –ê–±–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ
python -m app.telegram_bot
```

### 4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è AI-–∞–≥–µ–Ω—Ç–∞

1. **–ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à–æ–≥–æ –±–æ—Ç–∞ –≤ Telegram** –∑–∞ username
2. **–ù–∞–ø–∏—à—ñ—Ç—å `/start`** –¥–ª—è –∑–Ω–∞–π–æ–º—Å—Ç–≤–∞ –∑ –∞–≥–µ–Ω—Ç–æ–º
3. **–ü—Ä–æ—Å—Ç–æ —Å–ø—ñ–ª–∫—É–π—Ç–µ—Å—å –ø—Ä–∏—Ä–æ–¥–Ω–æ:**
   - –ù–∞–¥—ñ—à–ª—ñ—Ç—å YouTube URL ‚Üí –∞–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É—î
   - "–©–æ –¥—É–º–∞—é—Ç—å –ø—Ä–æ –∑–≤—É–∫?" ‚Üí –∑–Ω–∞–π–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö  
   - "–ü–æ–∫–∞–∂–∏ —Ç–æ–ø —Ç–µ–º–∏" ‚Üí –¥–∞—Å—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   - "–î–µ—Ç–∞–ª—ñ –ø—Ä–æ –∫—Ä–∏—Ç–∏–∫—É" ‚Üí –ø–æ–∫–∞–∂–µ —Ü–∏—Ç–∞—Ç–∏

**–û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å:** –ê–≥–µ–Ω—Ç —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏—Ä—ñ—à—É—î —è–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏!

### –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–±–æ—Ç–∏ –≤ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ:

```
ü§ñ –ó–∞–ø—É—Å–∫–∞—é YouTube Comment Consultant AI-–∞–≥–µ–Ω—Ç–∞...
üîß –ú–æ–¥–µ–ª—å –∞–≥–µ–Ω—Ç–∞: google/gemini-2.5-flash
ü§ñ –ë–æ—Ç @OnlyFansAI111bot (ID: 7981366461) –≥–æ—Ç–æ–≤–∏–π –¥–æ —Ä–æ–±–æ—Ç–∏!

üì® Processing message from user 12345: https://www.youtube.com/watch?v=dQw4w9WgXcQ
üé¨ Detected YouTube video: dQw4w9WgXcQ
üß† Calling google/gemini-2.5-flash for initial processing...
üéØ Agent decided: use tools
üîß Agent requested 1 tool calls
‚öôÔ∏è Executing tool 1/1...
üîß Executing tool: analyze_video with args: {'url_or_id': 'dQw4w9WgXcQ'}
üì∫ Starting video analysis for: dQw4w9WgXcQ...
‚úÖ Video analysis completed: 850 comments, 5 topics
üíæ Saved video_id dQw4w9WgXcQ for user 12345

[–ù–∞—Å—Ç—É–ø–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: "–©–æ –¥—É–º–∞—é—Ç—å –ø—Ä–æ —è–∫—ñ—Å—Ç—å –∑–≤—É–∫—É?"]
üì® Processing message from user 12345: –©–æ –¥—É–º–∞—é—Ç—å –ø—Ä–æ —è–∫—ñ—Å—Ç—å –∑–≤—É–∫—É?
üé¨ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ñ–¥–µ–æ: dQw4w9WgXcQ
üß† –î–æ–¥–∞—é –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –≤—ñ–¥–µ–æ: dQw4w9WgXcQ
üß† Calling google/gemini-2.5-flash for initial processing...
üéØ Agent decided: use tools
üîß Agent requested 1 tool calls
üîç Searching comments for question: –©–æ –¥—É–º–∞—é—Ç—å –ø—Ä–æ —è–∫—ñ—Å—Ç—å –∑–≤—É–∫—É?... (video: dQw4w9WgXcQ)
‚úÖ Found 3 relevant comments
```

### 5. CLI –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –ù–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –≤—ñ–¥–µ–æ
python -m app.analyze_llm analyze "https://www.youtube.com/watch?v=VIDEO_ID"

# –ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
python -m app.analyze_llm analyze "VIDEO_ID" --limit 800 --sqlite ./cache.db

# –ü–æ–∫–∞–∑–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
python -m app.analyze_llm show "VIDEO_ID"

# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –≤—ñ–¥–µ–æ
python -m app.analyze_llm list

# –û—á–∏—â–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
python -m app.analyze_llm clear --video "VIDEO_ID"  # –æ–¥–Ω–µ –≤—ñ–¥–µ–æ
python -m app.analyze_llm clear --all              # –≤—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
```

## üìä –¢–∞–∫—Å–æ–Ω–æ–º—ñ—è —Ç–µ–º

–°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫—É—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –∑–∞ 11 –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏:

- **–ü–æ—Ö–≤–∞–ª–∞/–ø–æ–¥—è–∫–∞** - –°—Ö–≤–∞–ª—å–Ω—ñ –≤—ñ–¥–≥—É–∫–∏, –∫–æ–º–ø–ª—ñ–º–µ–Ω—Ç–∏
- **–ö—Ä–∏—Ç–∏–∫–∞/–Ω–µ–∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è** - –ù–µ–≥–∞—Ç–∏–≤–Ω—ñ —Ä–µ–∞–∫—Ü—ñ—ó, –ø—Ä–µ—Ç–µ–Ω–∑—ñ—ó
- **–ü–∏—Ç–∞–Ω–Ω—è/—É—Ç–æ—á–Ω–µ–Ω–Ω—è** - –ü—Ä–æ—Ö–∞–Ω–Ω—è –ø–æ—è—Å–Ω–∏—Ç–∏, –¥–∞—Ç–∏ –ª—ñ–Ω–∫
- **–ü–æ—Ä–∞–¥–∏/–ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó** - –Ü–¥–µ—ó –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
- **–í–µ–¥—É—á–∏–π/–ø–µ—Ä—Å–æ–Ω–∞** - –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –ø—Ä–æ –≤–µ–¥—É—á–æ–≥–æ, –º–∞–Ω–µ—Ä—É –ø–æ–¥–∞—á—ñ
- **–¢–æ—á–Ω—ñ—Å—Ç—å/–ø—Ä–∞–≤–¥–∏–≤—ñ—Å—Ç—å** - –°—É–º–Ω—ñ–≤–∏ –≤ –¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ, —Ñ–∞–∫—Ç–∏—á–Ω—ñ –∑–∞—É–≤–∞–≥–∏
- **–ó–≤—É–∫/–≤—ñ–¥–µ–æ/–º–æ–Ω—Ç–∞–∂** - –¢–µ—Ö–Ω—ñ—á–Ω–∞ —è–∫—ñ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç—É
- **–¶—ñ–Ω–∏/—Ü—ñ–Ω–Ω—ñ—Å—Ç—å** - –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è —Ü—ñ–Ω–∏, –≤–∏–≥–æ–¥–∏, –æ–∫—É–ø–Ω–æ—Å—Ç—ñ
- **–û—Å–æ–±–∏—Å—Ç—ñ —ñ—Å—Ç–æ—Ä—ñ—ó** - –î–æ—Å–≤—ñ–¥ –≥–ª—è–¥–∞—á–∞, –ø—Ä–∏–≤–∞—Ç–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏
- **–û—Ñ—Ç–æ–ø/–∂–∞—Ä—Ç–∏/–º–µ–º–∏** - –ì—É–º–æ—Ä, –º–µ–º–∏, —Ñ–ª—É–¥ –Ω–µ –ø–æ —Ç–µ–º—ñ
- **–¢–æ–∫—Å–∏—á–Ω—ñ—Å—Ç—å/—Ö–µ–π—Ç** - –û–±—Ä–∞–∑–∏, –º–æ–≤–∞ –≤–æ—Ä–æ–∂–Ω–µ—á—ñ

## üß† AI-–∞–≥–µ–Ω—Ç –∑ Function Calling

### –ê–≤—Ç–æ–Ω–æ–º–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- **üéØ –°–∞–º–æ—Å—Ç—ñ–π–Ω–µ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω—å:** –∞–≥–µ–Ω—Ç –∞–Ω–∞–ª—ñ–∑—É—î –∑–∞–ø–∏—Ç —ñ –≤–∏–±–∏—Ä–∞—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
- **üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑:** YouTube URL ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è ‚Üí –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è  
- **üîç –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π –ø–æ—à—É–∫:** –ø–∏—Ç–∞–Ω–Ω—è ‚Üí –ø–æ—à—É–∫ —É –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
- **üìà –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ñ –¥–µ—Ç–∞–ª—ñ:** –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —Ü–∏—Ç–∞—Ç–∏, —Ç—Ä–µ–Ω–¥–∏

### –î–æ—Å—Ç—É–ø–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∞–≥–µ–Ω—Ç–∞

1. **`analyze_video`** ‚Äî –ø–æ–≤–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ YouTube –≤—ñ–¥–µ–æ
2. **`search_comments`** ‚Äî –ø–æ—à—É–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤  
3. **`get_analysis_data`** ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
4. **`get_topic_details`** ‚Äî –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ç–µ–º –∑ —Ü–∏—Ç–∞—Ç–∞–º–∏

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –º–æ–¥–µ–ª—ñ (–∑ function calling)

- **`google/gemini-2.5-flash`** ‚≠ê ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è (—à–≤–∏–¥–∫–æ + –¥–µ—à–µ–≤–æ)
- **`openai/gpt-4o`** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —è–∫—ñ—Å—Ç—å
- **`openai/gpt-4.1`** ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞

### –ü–µ—Ä—Å–æ–Ω–∞ –∞–≥–µ–Ω—Ç–∞

- **–ü—Ä–∏–Ω—Ü–∏–ø NotebookLM:** –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ **–≤–∏–∫–ª—é—á–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤**
- **–ß–µ—Å–Ω—ñ—Å—Ç—å:** —è–∫—â–æ –¥–∞–Ω–∏—Ö –Ω–µ–º–∞—î ‚Äî –ø—Ä—è–º–æ –ø—Ä–æ —Ü–µ –∫–∞–∂–µ
- **–ê–≤—Ç–æ–Ω–æ–º–Ω—ñ—Å—Ç—å:** —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏—Ä—ñ—à—É—î —è–∫—ñ –¥—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω—ñ  
- **–ë–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å:** —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –∞–¥–∞–ø—Ç—É—î—Ç—å—Å—è –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **üß† –ü–∞–º'—è—Ç—å:** –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î –æ—Å—Ç–∞–Ω–Ω—î –≤—ñ–¥–µ–æ —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É

### –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞ –ø–∞–º'—è—Ç—å

**–ù–æ–≤–∏–Ω–∫–∞!** –ê–≥–µ–Ω—Ç —Ç–µ–ø–µ—Ä –∑–∞–ø–∞–º'—è—Ç–æ–≤—É—î –æ—Å—Ç–∞–Ω–Ω—î –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –≤—ñ–¥–µ–æ:

‚úÖ **–ü—ñ—Å–ª—è –∞–Ω–∞–ª—ñ–∑—É –≤—ñ–¥–µ–æ:**
- "–©–æ –¥—É–º–∞—é—Ç—å –ø—Ä–æ –∑–≤—É–∫?" ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —à—É–∫–∞—î —É –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö —Ü—å–æ–≥–æ –≤—ñ–¥–µ–æ
- "–ü–æ–∫–∞–∂–∏ —Ç–æ–ø —Ç–µ–º–∏" ‚Üí –ø–æ–∫–∞–∑—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è —Ü—å–æ–≥–æ –≤—ñ–¥–µ–æ  
- "–î–µ—Ç–∞–ª—ñ –ø—Ä–æ –∫—Ä–∏—Ç–∏–∫—É" ‚Üí –∑–Ω–∞—Ö–æ–¥–∏—Ç—å —Ü–∏—Ç–∞—Ç–∏ –∑ –∫—Ä–∏—Ç–∏–∫–æ—é

‚ùå **–ù–ï –ø—Ä–æ—Å–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ URL** –¥–ª—è –ø–∏—Ç–∞–Ω—å –ø—Ä–æ —Ç–µ –∂ –≤—ñ–¥–µ–æ

üîÑ **–ù–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑:** —Ç—ñ–ª—å–∫–∏ –∫–æ–ª–∏ –≤–∏ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ –Ω–æ–≤–µ YouTube –ø–æ—Å–∏–ª–∞–Ω–Ω—è

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
app/
‚îú‚îÄ‚îÄ tools/
‚îÇ   ‚îú‚îÄ‚îÄ youtube.py               # –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –∑ YouTube API
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py            # –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å–∏–Ω–≥ —Ç–µ–∫—Å—Ç—É
‚îÇ   ‚îú‚îÄ‚îÄ topics_taxonomy.py       # –§—ñ–∫—Å–æ–≤–∞–Ω–∞ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è 11 —Ç–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ topics_llm.py            # LLM-–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ OpenRouter
‚îÇ   ‚îú‚îÄ‚îÄ classification_db.py     # –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –≤ SQLite
‚îÇ   ‚îî‚îÄ‚îÄ analyze_video_tool.py    # –í–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
‚îú‚îÄ‚îÄ agent_system.py              # üÜï AI-–∞–≥–µ–Ω—Ç –∑ function calling
‚îú‚îÄ‚îÄ telegram_bot.py              # üÜï Telegram –±–æ—Ç –∑ –∞–≥–µ–Ω—Ç–æ–º
‚îî‚îÄ‚îÄ analyze_llm.py               # CLI –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤
run_bot.py                       # üÜï –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É –¥–ª—è –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Telegram –±–æ—Ç–∞

### 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±–æ—Ç–∞

1. –ó–Ω–∞–π–¥—ñ—Ç—å [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –ù–∞–ø–∏—à—ñ—Ç—å `/newbot`
3. –í–∫–∞–∂—ñ—Ç—å –Ω–∞–∑–≤—É –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "YouTube Comment Consultant")
4. –í–∫–∞–∂—ñ—Ç—å username –±–æ—Ç–∞ (–º–∞—î –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—å –Ω–∞ `bot`)
5. –°–∫–æ–ø—ñ—é–π—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–∏–π **Bot Token**

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

–í—ñ–¥–ø—Ä–∞–≤—Ç–µ [@BotFather](https://t.me/BotFather) –∫–æ–º–∞–Ω–¥—É `/setcommands` —ñ –≤–∫–∞–∂—ñ—Ç—å:

```
start - –ü—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó
analyze - –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ YouTube –≤—ñ–¥–µ–æ
ask - –ó–Ω–∞–π—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö
```

## üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

–£—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ SQLite –ë–î:

### –¢–∞–±–ª–∏—Ü—ñ

- **`analyses`** ‚Äî —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–æ–≤–µ–¥–µ–Ω—ñ –∞–Ω–∞–ª—ñ–∑–∏
- **`comment_labels`** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—è  
- **`topics_summary`** ‚Äî –∑–≤–µ–¥–µ–Ω–Ω—è —Ç–µ–º –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ç–∞ —á–∞—Å—Ç–∫–∞–º–∏
- **`sentiment_summary`** ‚Äî üé≠ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ (–ø–æ–∑–∏—Ç–∏–≤–Ω–∞/–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞/–Ω–µ–≥–∞—Ç–∏–≤–Ω–∞)
- **`comments`** ‚Äî –∫–µ—à –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ (–∑ youtube.py)
- **`classification_results`** ‚Äî –∑–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è**: –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∞–Ω–∞–ª—ñ–∑–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ
- **–Ü—Å—Ç–æ—Ä—ñ—è –∞–Ω–∞–ª—ñ–∑—ñ–≤**: –±–æ—Ç "–±–∞—á–∏—Ç—å" —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ–π
- **–®–≤–∏–¥–∫–∏–π –¥–æ—Å—Ç—É–ø**: Q&A —Ç–∞ –¥–µ—Ç–∞–ª—ñ —Ç–µ–º –ø—Ä–∞—Ü—é—é—Ç—å –∑ –ë–î –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ LLM

## üíª –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∫–æ–¥—ñ

```python
from app.tools.youtube import fetch_comments
from app.tools.preprocess import select_fast_batch, preprocess_comments_df
from app.tools.topics_taxonomy import TAXONOMY, ID2NAME
from app.tools.topics_llm import classify_llm_full, aggregate_topics, sample_quotes
from app.tools.analyze_video_tool import analyze_video_tool, aggregate_sentiment
from app.tools.classification_db import load_classification_results, get_topic_statistics

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∫–µ—à—É—î—Ç—å—Å—è)
df_all = fetch_comments("VIDEO_URL", sqlite_path="./.cache.db")

# –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å–∏–Ω–≥ (–∑–∞–ª–∏—à–∞—î–º–æ –í–°–Ü –º–æ–≤–∏ –¥–ª—è LLM)
df_fast = select_fast_batch(df_all, mode="top_likes", limit=1200)
df_pre = preprocess_comments_df(df_fast, min_chars=12)  # keep_langs=None

# LLM-–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –ë–î)
df_classified = classify_llm_full(df_pre, TAXONOMY)

# –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
top_topics = aggregate_topics(df_classified).head(5)
sentiment_stats = aggregate_sentiment(df_classified)  # üé≠ –ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ!
quotes = sample_quotes(df_classified, topic_id="praise", k=3)

# üÜï –†–æ–±–æ—Ç–∞ –∑—ñ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
video_id = "26riTPNOJbc"

# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
df_saved = load_classification_results(video_id, "./.cache.db")

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—ñ–¥–µ–æ
stats = get_topic_statistics(video_id, "./.cache.db")
print(f"–ö–ª–∞—Å–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ: {stats['total_comments']} –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤")
print(f"–¢–æ–ø —Ç–µ–º–∞: {stats['topics'][0]['topic']}")
```

## üß™ Jupyter Notebook

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—é —Ä–æ–±–æ—Ç–∏ –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏ –≤ `.ipynb` —Ñ–∞–π–ª—ñ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É.

## ‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è

- **Batch —Ä–æ–∑–º—ñ—Ä**: 10-20 –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –Ω–∞ –∑–∞–ø–∏—Ç –¥–æ LLM
- **Concurrency**: –î–æ 10 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ OpenRouter
- **–ö–µ—à—É–≤–∞–Ω–Ω—è**: SQLite –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
- **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è**: –û–±—Ä–æ–±–∫–∞ –ª–∏—à–µ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤

## üõ°Ô∏è –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –æ–±–º–µ–∂–µ–Ω–Ω—è

### –ë–µ–∑–ø–µ–∫–∞

- **–ù—ñ—è–∫–∏—Ö –º–µ–¥–∏—á–Ω–∏—Ö/—Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –ø–æ—Ä–∞–¥**: –±–æ—Ç —É–Ω–∏–∫–∞—î –Ω–∞–¥–∞–Ω–Ω—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü—ñ–π –≤ —Å–µ–Ω—Å–∏—Ç–∏–≤–Ω–∏—Ö —Å—Ñ–µ—Ä–∞—Ö
- **–ë–µ–∑ –æ—Å–æ–±–∏—Å—Ç–∏—Ö –¥–∞–Ω–∏—Ö**: –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –Ω–µ –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è –ø–æ—ñ–º–µ–Ω–Ω–æ
- **–ù–µ–π—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—ñ**: –ø—Ä–∏ —Ç–æ–∫—Å–∏—á–Ω–∏—Ö —Ç–µ–º–∞—Ö –±–æ—Ç –ø–æ–º'—è–∫—à—É—î —Ç–æ–Ω —É —á–µ—Ä–Ω–µ—Ç–∫–∞—Ö
- **–û–±–º–µ–∂–µ–Ω–Ω—è –¥–∂–µ—Ä–µ–ª**: –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç—ñ–ª—å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ YouTube

### –û–±–º–µ–∂–µ–Ω–Ω—è

- **–ü—Ä–∏–≤–∞—Ç–Ω—ñ –≤—ñ–¥–µ–æ**: —è–∫—â–æ –≤—ñ–¥–µ–æ –ø—Ä–∏–≤–∞—Ç–Ω–µ –∞–±–æ –±–µ–∑ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ ‚Äî –∑—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É
- **–ö–≤–æ—Ç–∏ API**: –ø—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ –∫–≤–æ—Ç YouTube/OpenRouter ‚Äî –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∞ –∫–æ—Ä–∏—Å–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- **–ú–æ–≤–∞**: –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —É–∫—Ä–∞—ó–Ω—Å—å–∫–∞, –∞–ª–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –º–æ–≤–æ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- **–†–æ–∑–º—ñ—Ä**: –∞–Ω–∞–ª—ñ–∑ –¥–æ ~1200 –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –≤ —à–≤–∏–¥–∫–æ–º—É —Ä–µ–∂–∏–º—ñ (–¥–ª—è –µ–∫–æ–Ω–æ–º—ñ—ó —Ç–æ–∫–µ–Ω—ñ–≤)

## ‚ö° –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

### LLM –≤–∏–∫–ª–∏–∫–∏

- **Batch —Ä–æ–∑–º—ñ—Ä**: 10-25 –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –Ω–∞ –∑–∞–ø–∏—Ç
- **Temperature**: 0.0 –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, 0.4-0.5 –¥–ª—è —á–µ—Ä–Ω–µ—Ç–æ–∫
- **–¢–æ–∫–µ–Ω–∏**: –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –æ–±—Ä—ñ–∑–∞—é—Ç—å—Å—è –¥–æ ~500 —Å–∏–º–≤–æ–ª—ñ–≤
- **–ü–∞—Ä–∞–ª–µ–ª—å–Ω—ñ—Å—Ç—å**: –¥–æ 10 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ OpenRouter
- **JSON —Ñ–æ—Ä–º–∞—Ç**: —Å—Ç—Ä–æ–≥–∏–π `response_format={"type":"json_object"}`

### –õ–æ–≥—É–≤–∞–Ω–Ω—è

–ë–æ—Ç –ª–æ–≥—É—î –∫–æ–∂–µ–Ω –±–∞—Ç—á: –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏–∫–ª–∞–¥—ñ–≤, –æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω—ñ —Ç–æ–∫–µ–Ω–∏, latency (—Å–µ–∫).
–£ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É ‚Äî —Å—Ç–∏—Å–ª–∞ –∑–≤–µ–¥–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞: —Å–∫—ñ–ª—å–∫–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –∑—ñ–±—Ä–∞–Ω–æ/–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ.

## üéì –ü–µ—Ä–µ–≤–∞–≥–∏ AI-–∞–≥–µ–Ω—Ç–∞

- üß† **Function Calling**: –∞–≥–µ–Ω—Ç —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –≤–∏–±–∏—Ä–∞—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
- üéØ **–ê–≤—Ç–æ–Ω–æ–º–Ω—ñ—Å—Ç—å**: –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –∫–æ–º–∞–Ω–¥ ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–ø—ñ–ª–∫—É–π—Ç–µ—Å—å –ø—Ä–∏—Ä–æ–¥–Ω–æ
- üìö **–ü—Ä–∏–Ω—Ü–∏–ø NotebookLM**: –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤–∏–∫–ª—é—á–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
- üö´ **–ù–µ –≤–∏–≥–∞–¥—É—î**: —á–µ—Å–Ω–æ –∫–∞–∂–µ –∫–æ–ª–∏ –¥–∞–Ω–∏—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ
- üí¨ **–ü—Ä–∏—Ä–æ–¥–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è**: YouTube URL ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑
- üá∫üá¶ **–ë–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å**: –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó —Ç–∞ —ñ–Ω—à–∏—Ö –º–æ–≤
- ‚ö° **–®–≤–∏–¥–∫—ñ—Å—Ç—å**: Gemini 2.5 Flash –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏/—è–∫–æ—Å—Ç—ñ
- üõ°Ô∏è **–ë–µ–∑–ø–µ–∫–∞**: –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –º–µ–¥–∏—á–Ω—ñ/—Ñ—ñ–Ω–∞–Ω—Å–æ–≤—ñ –ø–æ—Ä–∞–¥–∏
- üîÑ **–ö–µ—à—É–≤–∞–Ω–Ω—è**: –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ
- üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Ü–∏—Ç–∞—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
